table.captured <- replace.vars.string(replacement.matrix=replacement.var.names,
input.table=table.captured, html=TRUE, table.only=FALSE )
cat(table.captured, sep="\n")
cat(table.captured, sep="\n")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
cat(table.captured, sep="\n")
dhurdle.mfx.bootstrapped <- dhurdle.mfx.bootstrapped[
!grepl("[Dd]epartment", dhurdle.mfx.bootstrapped$param.names),  ]
throwaway <- capture.output(table.captured <- stargazer( dhurdle.mfx.bootstrapped[, 1:5 ], type="html",
summary=FALSE, out.header = FALSE, align=TRUE,
rownames=FALSE, font.size="small",
column.sep.width="0pt",
title=paste0("Extensive margin decision: marginal effects. (n = ", nrow(crop.wide.df), ") <br> Dependent variable: Fertilizer Expenditure Per Hectare"),
#  float.env = "sidewaystable",
notes="Signif codes: *** = 0.1\\%; ** = 1\\%; * = 5\\%; . = 10\\%. Reference levels for Education: Primary. \n Region variables omitted but are economically and statistically significant. \n Indigenous proportion X education interaction included in underlying specification"))
replace.vars.string <- function(replacement.matrix, input.table, html=FALSE, table.only=TRUE )
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("<table >", "<table class=mytable>", table.captured)
source("/Users/travismcarthur/git/misc/authored-functions/authored-R-fns.R")
replacement.var.names <- read.csv("/Users/travismcarthur/Desktop/Metrics (637)/Final paper/tex building/MECOVI var name replacements.csv", stringsAsFactors=FALSE)
table.captured <- replace.vars.string(replacement.matrix=replacement.var.names,
input.table=table.captured, html=TRUE, table.only=FALSE )
cat(table.captured, sep="\n")
dhurdle.mfx.bootstrapped <- dhurdle.mfx.bootstrapped[
!grepl("[Dd]epartment", dhurdle.mfx.bootstrapped$param.names),  ]
throwaway <- capture.output(table.captured <- stargazer( dhurdle.mfx.bootstrapped[, 1:5 ], type="html",
summary=FALSE, out.header = FALSE, align=TRUE,
rownames=FALSE, font.size="small",
column.sep.width="0pt",
title=paste0("Extensive margin decision: marginal effects. (n = ", nrow(crop.wide.df), ") <br> Dependent variable: Fertilizer Expenditure Per Hectare"),
#  float.env = "sidewaystable",
notes="Signif codes: *** = 0.1\\%; ** = 1\\%; * = 5\\%; . = 10\\%. Reference levels for Education: Primary. \n Region variables omitted but are economically and statistically significant. \n Indigenous proportion X education interaction included in underlying specification"))
replace.vars.string <- function(replacement.matrix, input.table, html=FALSE, table.only=TRUE )
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured
gsub("style=\".+?\"", "", table.captured)
dhurdle.mfx.bootstrapped <- dhurdle.mfx.bootstrapped[
!grepl("[Dd]epartment", dhurdle.mfx.bootstrapped$param.names),  ]
throwaway <- capture.output(table.captured <- stargazer( dhurdle.mfx.bootstrapped[, 1:5 ], type="html",
summary=FALSE, out.header = FALSE, align=TRUE,
rownames=FALSE, font.size="small",
column.sep.width="0pt",
title=paste0("Extensive margin decision: marginal effects. (n = ", nrow(crop.wide.df), ") <br> Dependent variable: Fertilizer Expenditure Per Hectare"),
#  float.env = "sidewaystable",
notes="Signif codes: *** = 0.1\\%; ** = 1\\%; * = 5\\%; . = 10\\%. Reference levels for Education: Primary. \n Region variables omitted but are economically and statistically significant. \n Indigenous proportion X education interaction included in underlying specification"))
replace.vars.string <- function(replacement.matrix, input.table, html=FALSE, table.only=TRUE )
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("<table >", "<table class=mytable>", table.captured)
source("/Users/travismcarthur/git/misc/authored-functions/authored-R-fns.R")
replacement.var.names <- read.csv("/Users/travismcarthur/Desktop/Metrics (637)/Final paper/tex building/MECOVI var name replacements.csv", stringsAsFactors=FALSE)
table.captured <- replace.vars.string(replacement.matrix=replacement.var.names,
input.table=table.captured, html=TRUE, table.only=FALSE )
cat(table.captured, sep="\n")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
names(dhurdle.mfx.bootstrapped)
colnames(dhurdle.mfx.bootstrapped) <- c("Variable", "Point estimate", "Lower 95% CI", "Upper 95% CI", "", "", "", "", "")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
load("/Users/travismcarthur/Desktop/Metrics (637)/Final paper/Rdata results files/double hurdle.Rdata")
unprocessed.summary.table
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
throwaway <- capture.output(table.captured <- stargazer(unprocessed.summary.table , summary=FALSE, out.header = FALSE, out=paste0(work.dir, "tex building/hurdlesummary.tex"),
rownames=TRUE,
title="Summary statistics of MECOVI data", align=TRUE,
notes="Drive time in hours. Rainfall in meters.  Remittances in hundreds of Bolivianos."))
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("<table >", "<table class=mytable>", table.captured)
cat(table.captured, sep="\n")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
throwaway <- capture.output(table.captured <- stargazer(unprocessed.summary.table , summary=FALSE, type="html", out.header = FALSE, out=paste0(work.dir, "tex building/hurdlesummary.tex"),
rownames=TRUE,
title="Summary statistics of MECOVI data", align=TRUE,
notes="Drive time in hours. Rainfall in meters.  Remittances in hundreds of Bolivianos."))
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("<table >", "<table class=mytable>", table.captured)
cat(table.captured, sep="\n")
names(unprocessed.summary.table)
str(unprocessed.summary.table)
throwaway <- capture.output(table.captured <- stargazer(unprocessed.summary.table , summary=FALSE, type="html", out.header = FALSE, out=paste0(work.dir, "tex building/hurdlesummary.tex"),
rownames=TRUE,
title="Summary statistics of MECOVI data", align=TRUE,
notes="Drive time in hours. Rainfall in meters.  Remittances in hundreds of Bolivianos."))
table.captured <- gsub("style=\".+?\"", "", table.captured)
table.captured <- gsub("<table >", "<table class=mytable>", table.captured)
cat(table.captured, sep="\n")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
rownames(unprocessed.summary.table)
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
?points
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
?save.image
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
setwd("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14")
slidify("/Users/travismcarthur/git/slidify-presentations/slidify-presentations-pages/SRC-10-29-14/index.Rmd")
?RDestimate
summary( RDestimate(harvest.r.MAIZ ~ area.r.MAIZ, data=crop.wide.df, cutpoint = area.median))
work.dir <- "/Users/travismcarthur/Desktop/Metrics (637)/Final paper/"
load(paste0(work.dir, "crop wide df2.Rdata"))
names(crop.wide.df) <- gsub("[.]+$", "", names(crop.wide.df))
crop.wide.df <- crop.wide.df[crop.wide.df$harvest.r.MAIZ>0 & crop.wide.df$area.r.MAIZ>0, ]
cor.test(crop.wide.df$harvest.r.MAIZ, crop.wide.df$area.r.MAIZ)
area.median <- median(crop.wide.df$area.r.MAIZ)
crop.wide.df$fake.treatment <- ifelse(crop.wide.df$area.r.MAIZ>area.median, TRUE, FALSE)
# install.packages("rdd")
library("rdd")
#Outcome ~ Running_variable + Treatment_variable | Covariate_1 + Covariate_2
# area.r.MAIZ +
summary( RDestimate(harvest.r.MAIZ ~ area.r.MAIZ, data=crop.wide.df, cutpoint = area.median))
summary( RDestimate(harvest.r.MAIZ ~ area.r.MAIZ, data=crop.wide.df, cutpoint = area.median), kernel="rectangular")
h1 <- 0.1
x <- crop.wide.df$area.r.MAIZ
kern11u <- ifelse( x>0.5 & x<(0.5+h1), 1, 0)
kern11l <- ifelse(x<0.5 & x>(0.5-h1), 1, 0)
predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l))
h1 <- 0.1
x <- crop.wide.df$area.r.MAIZ
y <- crop.wide.df$harvest.r.MAIZ
kern11u <- ifelse( x>0.5 & x<(0.5+h1), 1, 0)
kern11l <- ifelse(x<0.5 & x>(0.5-h1), 1, 0)
predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l))
summary(predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l)))
h1 <- 0.3
x <- crop.wide.df$area.r.MAIZ
y <- crop.wide.df$harvest.r.MAIZ
kern11u <- ifelse( x>0.5 & x<(0.5+h1), 1, 0)
kern11l <- ifelse(x<0.5 & x>(0.5-h1), 1, 0)
summary(predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l)))
area.median
predict(lm( y ~ x, weights=kern11u), newdata=data.frame(x=area.median)) -
predict(lm( y ~ x, weights=kern11l), newdata=data.frame(x=area.median))
lm( y ~ x, weights=kern11u)
lm( y ~ x, weights=kern11l)
plot(x, y)
plot(log(x), log(y )
)
log(.5)
log(.8)
log(.2)
?poly
lm( y ~ gt5*poly(x, degree=4, raw=TRUE))
gen gt5 <- ifelse(x > area.median , 1, 0)
lm( y ~ gt5*poly(x, degree=4, raw=TRUE))
gt5 <- ifelse(x > area.median , 1, 0)
lm( y ~ gt5*poly(x, degree=4, raw=TRUE))
lm( y ~ gt5*poly(x, degree=5, raw=TRUE))
lm( y ~ gt5*poly(x, degree=3, raw=TRUE))
predict(lm( y ~ x, weights=kern11u), newdata=data.frame(x=area.median)) -
predict(lm( y ~ x, weights=kern11l), newdata=data.frame(x=area.median))
lm( y ~ gt5*poly(x, degree=3, raw=TRUE))
summary(predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l)))
lm( y ~ gt5*poly(x, degree=3, raw=TRUE))
lm( y ~ gt5*poly(x, degree=3, raw=F))
lm( y ~ gt5*poly(x, degree=3, raw=TRUE))
?jitter
jitter(rep(0.5, 1000, 5)
)
jitter(rep(0.5, 1000), 5)
set.seed(100)
x <- runif(1000)
Tr <- elseif(x > jitter(rep(0.5, 1000), 5), 1 ,0 )
g=T+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 5), 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
line(v=.5)
?line
?hline
?abline
abline(v=.5)
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 10), 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
set.seed(100)
x <- runif(1000)
#Tr <- ifelse(x > jitter(rep(0.5, 1000), 10), 1 ,0 )
Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 1), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg( y ~ Tr*poly(x, degree=3, raw=TRUE) |
I(x>.5)*poly(x, degree=3, raw=TRUE)))
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 1), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg( y ~ Tr*poly(x, degree=3, raw=TRUE) |
I(x>.5)*poly(x, degree=3, raw=TRUE)))
lm( y ~ y ~ Tr*poly(x, degree=3, raw=TRUE))
lm( y ~ Tr*poly(x, degree=3, raw=TRUE))
lm( y ~ Tr*poly(x, degree=8, raw=TRUE))
-2.155e+03
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 1), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg( y ~ Tr*poly(x, degree=3, raw=TRUE) |
I(x>.5)*poly(x, degree=3, raw=TRUE)))
lm( y ~ Tr*poly(x, degree=8, raw=TRUE))
summary(lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
set.seed(100)
x <- runif(1000)
#Tr <- ifelse(x > jitter(rep(0.5, 1000), 1), 1 ,0 )
Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg( y ~ Tr*poly(x, degree=3, raw=TRUE) |
I(x>.5)*poly(x, degree=3, raw=TRUE)))
summary(lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
3.451e+03
plot(x, y)
summary(lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
summary(y)
summary(lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
ploy(2, degree=8, raw=TRUE)
poly(2, degree=8, raw=TRUE)
2^8
plot(predict(test.lm ))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
plot(predict(test.lm ))
?predict
plot(x=x, predict(test.lm ))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
plot(x, y)
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
plot(x=x, predict(test.lm ))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=F)))
plot(x=x, predict(test.lm ))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr*(x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) )))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
Tr
T
set.seed(100)
x <- runif(10000)
#Tr <- ifelse(x > jitter(rep(0.5, 1000), 1), 1 ,0 )
Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(10000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg( y ~ Tr*poly(x, degree=3, raw=TRUE) |
I(x>.5)*poly(x, degree=3, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr*poly(x, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr*(x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) )))
summary(test.lm <- lm( y ~ Tr:poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr + x + Tr:poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr + x + Tr:poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr + x + poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
9.774e-01
summary(test.lm <- lm( y ~ Tr +  poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
lm( y ~ gt5 + poly(x, degree=3, raw=TRUE) + gt5:poly(x-area.median, degree=3, raw=TRUE))
h1 <- 0.3
x <- crop.wide.df$area.r.MAIZ
y <- crop.wide.df$harvest.r.MAIZ
kern11u <- ifelse( x>area.median & x<(area.median+h1), 1, 0)
kern11l <- ifelse(x<area.median & x>(area.median-h1), 1, 0)
# Kernel Regression
summary(predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l)))
# Local linear regression
predict(lm( y ~ x, weights=kern11u), newdata=data.frame(x=area.median)) -
predict(lm( y ~ x, weights=kern11l), newdata=data.frame(x=area.median))
# Polynomials
gt5 <- ifelse(x > area.median , 1, 0)
lm( y ~ gt5 + poly(x, degree=3, raw=TRUE) + gt5:poly(x-area.median, degree=3, raw=TRUE))
predict(lm( y ~ x, weights=kern11u), newdata=data.frame(x=area.median)) -
predict(lm( y ~ x, weights=kern11l), newdata=data.frame(x=area.median))
summary(predict(lm( y ~ 1, weights=kern11u)) - predict(lm( y ~ 1, weights=kern11l)))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE) |
I(x>.5) +  poly(x, degree=8, raw=TRUE) + I(x>.5):poly(x-0.5, degree=8, raw=TRUE)
))
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 10), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE) |
I(x>.5) +  poly(x, degree=8, raw=TRUE) + I(x>.5):poly(x-0.5, degree=8, raw=TRUE)
))
set.seed(100)
x <- runif(1000)
#Tr <- ifelse(x > jitter(rep(0.5, 1000), 10), 1 ,0 )
Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
summary(test.lm <- lm( y ~ Tr +  poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
summary(test.lm <- lm( y ~ Tr +  poly(x, degree=8) + Tr:poly(x-0.5, degree=8)))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=3, raw=TRUE) + Tr:poly(x-0.5, degree=3, raw=TRUE) |
I(x>.5) +  poly(x, degree=3, raw=TRUE) + I(x>.5):poly(x-0.5, degree=3, raw=TRUE)
))
summary(test.lm <- lm( y ~ Tr +  poly(x, degree=8) + Tr:poly(x-0.5, degree=8)))
summary(test.lm <- lm( y ~ Tr +  poly(x, degree=8, raw=TRUE) + Tr:poly(x-0.5, degree=8, raw=TRUE)))
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 10), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
#summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=3, raw=TRUE) + Tr:poly(x-0.5, degree=3, raw=TRUE) |
I(x>.5) +  poly(x, degree=3, raw=TRUE) + I(x>.5):poly(x-0.5, degree=3, raw=TRUE)
))
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 5), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
#summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=3, raw=TRUE) + Tr:poly(x-0.5, degree=3, raw=TRUE) |
I(x>.5) +  poly(x, degree=3, raw=TRUE) + I(x>.5):poly(x-0.5, degree=3, raw=TRUE)
))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=5, raw=TRUE) + Tr:poly(x-0.5, degree=5, raw=TRUE) |
I(x>.5) +  poly(x, degree=5, raw=TRUE) + I(x>.5):poly(x-0.5, degree=5, raw=TRUE)
))
set.seed(100)
x <- runif(1000)
Tr <- ifelse(x > jitter(rep(0.5, 1000), 5), 1 ,0 )
#Tr <- ifelse(x > .5, 1 ,0 )
g=Tr+3*log(x+1)+sin(x*12)/3
y <- g+qnorm(runif(1000))/5
plot(x, y)
abline(v=.5)
library("AER")
#summary(fert.ivreg <- ivreg( log(fert.exp+1) ~ log(remittances+1) + log(total.area) | hhh.sex + log(total.area), data=crop.wide.df))
#summary(dummy.ivreg <- ivreg( y ~ x | Tr))
summary(dummy.ivreg <- ivreg(
y ~ Tr +  poly(x, degree=5, raw=TRUE) + Tr:poly(x-0.5, degree=5, raw=TRUE) |
I(x>.5) +  poly(x, degree=5, raw=TRUE) + I(x>.5):poly(x-0.5, degree=5, raw=TRUE)
))
?ivreg
load("/Users/travismcarthur/Desktop/Metrics (637)/Final paper/Rdata results files/double hurdle.Rdata")
str)crops.wide.df
str(crops.wide.df)
str(crop.wide.df)
cor.test(crop.wide.df$received.credit, crop.wide.df$hhh.sex)
cor.test(as.numeric(crop.wide.df$received.credit), crop.wide.df$hhh.sex)
chisq.test(crop.wide.df$received.credit, crop.wide.df$hhh.sex)
names(crop.wide.df)
cor.test(as.numeric(crop.wide.df$received.credit), crop.wide.df$drive.time.urban)
cor.test(as.numeric(crop.wide.df$received.credit), crop.wide.df$amanzanada)
cor.test(as.numeric(crop.wide.df$received.credit), crop.wide.df$drive.time.amanzanada)
cor.test(as.numeric(crop.wide.df$received.credit), crop.wide.df$hhh.literacy)
cor.test(as.numeric(crop.wide.df$received.credit), as.numeric(crop.wide.df$hhh.literacy))
chisq.test(crop.wide.df$received.credit, crop.wide.df$hhh.literacy)
str(crop.wide.df$received.credit)
summary(fert.ivreg <- ivreg( log(fert.exp+1) ~
received.credit + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
hhh.literacy + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
summary(fert.ivreg <- ivreg( I(fert.exp>0) ~
received.credit + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
hhh.literacy + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
summary(fert.ivreg <- ivreg( log(fert.exp+1) ~
received.credit + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
hhh.literacy + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
crop.wide.df$Z_i <- runif(nrow(crop.wide.df))
beta_1 <- 6
beta_2 <- 4
crop.wide.df$T_i <- with(crop.wide.df, 1 + beta_1 * Z_i +
beta_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=5) )
gamma_1 <- 15
gamma_2 <- 20
crop.wide.df$Y_i <- with(crop.wide.df, 1 + gamma_1 * T_i +
gamma_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=7) )
summary(fert.ivreg.perfect <- ivreg( Y_i ~
T_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
Z_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
crop.wide.df$hhh.sex
#target.vars <- c("received.credit", "indig.prop", "drive.time.urban", "mean.ann.rain.5yr", "elevation" "hhh.sex")
crop.wide.df$hhh.sex <- ifelse(crop.wide.df$hhh.sex=="hombre", 1, 0)
crop.wide.df$Z_i <- runif(nrow(crop.wide.df))
beta_1 <- 6
beta_2 <- 4
crop.wide.df$T_i <- with(crop.wide.df, 1 + beta_1 * Z_i +
beta_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=5) )
gamma_1 <- 15
gamma_2 <- 20
crop.wide.df$Y_i <- with(crop.wide.df, 1 + gamma_1 * T_i +
gamma_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=7) )
summary(fert.ivreg.perfect <- ivreg( Y_i ~
T_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
Z_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
crop.wide.df$Z_i <- runif(nrow(crop.wide.df))
beta_1 <- 6
beta_2 <- 4
crop.wide.df$T_i <- with(crop.wide.df, 1 + beta_1 * Z_i +
beta_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=20) )
gamma_1 <- 15
gamma_2 <- 20
crop.wide.df$Y_i <- with(crop.wide.df, 1 + gamma_1 * T_i +
gamma_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=15) )
summary(fert.ivreg.perfect <- ivreg( Y_i ~
T_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
Z_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
crop.wide.df$Z_i <- runif(nrow(crop.wide.df))
beta_1 <- 6
beta_2 <- 4
crop.wide.df$T_i <- with(crop.wide.df, 1 + beta_1 * Z_i +
beta_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=200) )
gamma_1 <- 15
gamma_2 <- 20
crop.wide.df$Y_i <- with(crop.wide.df, 1 + gamma_1 * T_i +
gamma_2*(indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex) +
rnorm(nrow(crop.wide.df), sd=100) )
summary(fert.ivreg.perfect <- ivreg( Y_i ~
T_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex |
Z_i + indig.prop + drive.time.urban + mean.ann.rain.5yr + elevation + hhh.sex,
data=crop.wide.df))
ls()
